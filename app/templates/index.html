{% extends "base.html" %}

{% block content %}
<h2>Add New Link</h2>
<form hx-post="/api/links" hx-target="#links-table-body" hx-swap="afterbegin" hx-on::after-request="if(event.detail.successful && event.detail.xhr.getResponseHeader('HX-Retarget') !== '#form-error') { this.reset(); document.getElementById('form-error').innerHTML = ''; }">
    <input type="text" name="short_link" placeholder="short-link" required>
    <input type="url" name="url" placeholder="https://example.com" required>
    <button type="submit">Add</button>
</form>
<div id="form-error"></div>

<h2>Existing Links</h2>
<input type="search"
       name="q"
       placeholder="Search links..."
       hx-get="/api/links"
       hx-trigger="keyup changed delay:500ms, search"
       hx-target="#links-table-body"
       hx-select="#links-table-body tr"
       style="margin-bottom: 1em; width: 100%; box-sizing: border-box;">

<div id="links-list" hx-get="/api/links" hx-trigger="load">
    <p>Loading links...</p>
</div>
{% endblock %}
